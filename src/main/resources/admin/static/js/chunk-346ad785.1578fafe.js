(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-346ad785"],{8039:function(e,t,n){},ae7c:function(e,t,n){"use strict";var a=n("8039"),r=n.n(a);r.a},b2ac:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"dropzone-container"},[n("vue-dropzone",{ref:"myVueDropzone",attrs:{id:"dropzone",options:e.dropzoneOptions},on:{"vdropzone-success":e.handleSuccess}})],1),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.files,border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{align:"center",label:"ID",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",[e._v(e._s(a.id))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"上传者"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",[e._v(e._s(a.author.username))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"文件名"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v("\n        "+e._s(n.filename)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"文件类型"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v("\n        "+e._s(n.mimetype)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"文件大小"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v("\n        "+e._s(e._f("toKB")(n.size))+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"日期"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v("\n        "+e._s(e._f("parseTime")(n.timestamp,"{y}-{m}-{d} {h}:{i}"))+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"操作","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(t){return e.delFile(a.id)}}},[e._v("\n          删除\n        ")])]}}])})],1),e._v(" "),n("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{background:"",layout:"prev, pager, next",total:e.page.total,"page-size":e.page.size,"current-page":e.page.current},on:{"current-change":e.currentChangeHandler}})],1)},r=[],i=n("f7cc"),o=n.n(i),l=(n("9125"),n("b775"));function s(e,t){return Object(l["a"])({url:"/files",method:"get",params:{page:e,size:t}})}function c(e){return Object(l["a"])({url:"/files/"+e,method:"delete"})}var u=n("5f87"),d={name:"Upload",components:{vueDropzone:o.a},filters:{toKB:function(e){return parseInt(e/1024)+" KB"}},data:function(){return{listLoading:!0,files:void 0,dropzoneOptions:{url:"/api/files",thumbnailWidth:150,maxFilesize:.5,headers:{"X-Token":Object(u["a"])()}},page:{total:0,size:10,current:1}}},created:function(){this.getList()},methods:{getList:function(){var e=this;s(this.page.current,this.page.size).then((function(t){e.listLoading=!0,e.files=t.records,e.page.total=t.total,e.listLoading=!1}))},currentChangeHandler:function(e){var t=this;this.listLoading=!0,this.page.current=e,s(e,this.page.size).then((function(e){t.files=e.records,t.page.total=e.total,t.listLoading=!1}))},delFile:function(e){var t=this;this.$confirm("此操作将永久该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){c(e).then((function(n){t.$message({showClose:!0,message:"文件删除成功",type:"success"}),t.files=t.files.filter((function(t){return t.id!==e})),t.page.total=t.page.total-1,Math.ceil(t.page.total/t.page.size)<t.page.current&&(t.page.current=t.page.current-1),t.currentChangeHandler(t.page.current)}))})).catch((function(){}))},handleSuccess:function(){var e=this;s(this.page.current,this.page.size).then((function(t){e.listLoading=!0,e.files=t.records,e.page.total=t.total,e.listLoading=!1}))}}},p=d,f=(n("ae7c"),n("6691")),g=Object(f["a"])(p,a,r,!1,null,"11192c50",null);t["default"]=g.exports}}]);